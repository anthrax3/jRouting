function jRinit(){jR.async(),$.fn.jRouting=function(r){if(jR.hashtags||!jR.isModernBrowser)return this;var t=+$.fn.jquery.replace(/\./g,'');if(t>=300&&r===!0)throw Error('$(selector).jRouting() doesn\'t work in jQuery +3. Instead of this use jR.clientside(selector).');var n=function(r){r.preventDefault(),jR.redirect($(this).attr('href'))};return r?$(document).on('click',this.selector,n):this.filter('a').bind('click',n),this},$(document).ready(function(){jR.async(),jR.hashtags?jR.url=location.hash||JRFU.path(JRFU.prepareUrl(location.pathname)):jR.url=JRFU.path(JRFU.prepareUrl(location.pathname)),jR.events.ready?(jR.emit('ready',jR.url),jR.emit('load',jR.url)):setTimeout(function(){jR.isReady=!0,jR.location(jR.url),jR.emit('ready',jR.url),jR.emit('load',jR.url)},5),$(window).on('hashchange',function(){jR.isReady&&jR.hashtags&&jR.location(JRFU.path(location.hash))}),$(window).on('popstate',function(){if(jR.isReady&&!jR.hashtags){var r=JRFU.path(location.pathname);jR.url!==r&&jR.location(r)}})})}var JRFU={},jR={LIMIT_HISTORY:100,LIMIT_HISTORY_ERROR:100,version:'v2.0.0',cache:{},routes:[],history:[],errors:[],events:{},eventsOnce:{},global:{},query:{},params:[],middlewares:{},repository:{},url:'',model:null,isFirst:!0,isReady:!1,isRefresh:!1,isModernBrowser:!!history.pushState,hashtags:!1,count:0};window.jR||(window.jR=jR),window.jRouting||(window.jRouting=jR),window.JRFU||(window.JRFU=JRFU),jR.remove=function(r){for(var t=this,n=[],e=0,i=t.routes.length;e<i;e++)t.routes[e].id!==r&&n.push(t.routes[e]);return t.routes=n,t},jR.on=function(r,t){var n=this,e=n.events[r];return e?e.push(t):n.events[r]=[t],n},jR.once=function(r,t){var n=this,e=n.eventsOnce[r];return e?e.push(t):n.eventsOnce[r]=[t],n},jR.emit=function(r){var t=this,n=t.events[r]||[],e=t.eventsOnce[r]||[],i=n.length,o=e.length;if(!i&&!o)return t;for(var a=[],s=arguments.length,u=1;u<s;u++)a.push(arguments[u]);if(i>0)for(var u=0;u<i;u++)n[u].apply(t,a);if(o){for(var u=0;u<i;u++)e[u].apply(t,a);delete t.eventsOnce[r]}},jR.route=function(r,t,n,e){var i;if(t instanceof Array){var i=n;n=t,t=i}'function'==typeof n&&(i=e,e=n,n=i);var o=this,a=r.count('/')+(r.indexOf('*')===-1?0:10),s=o._route(r.trim()),u=[];if('string'==typeof n&&(n=n.split(',')),r.indexOf('{')!==-1){a-=100;for(var l=0;l<s.length;l++)'{'===s[l].substring(0,1)&&u.push(l);a-=u.length}return o.routes.remove(r),o.routes.push({id:r,url:s,fn:t,priority:a,params:u,middleware:n||null,init:e,count:0,pending:!1}),o.routes.sort(function(r,t){return r.priority>t.priority?-1:r.priority<t.priority?1:0}),o},jR.middleware=function(r,t){var n=this;return n.middlewares[r]=t,n},jR.refresh=function(){var r=this;return r.location(r.url,!0)},jR.reload=function(){return jR.refresh()},jR.async=function(){if(window.jRoute&&window.jRoute.length){for(;;){var r=window.jRoute.shift();if(!r)break;r()}jR.is404&&jR.location(jR.url)}},jR._route=function(r){47===r.charCodeAt(0)&&(r=r.substring(1)),47===r.charCodeAt(r.length-1)&&(r=r.substring(0,r.length-1));var t=r.split('/');return 1!==t.length||t[0]||(t[0]='/'),t},jR._route_param=function(r,t){var n=[];if(!t||!r)return n;var e=t.params.length;if(e)for(var i=0;i<e;i++){var o=r[t.params[i]];n.push('/'===o?'':o)}return n},jR._route_compare=function(r,t){var n=r.length,e=1===n&&'/'===r[0];if(t.length!==n)return!1;for(var i=0;i<n;i++){var o=t[i];if(!o)return!1;if(e||123!==o.charCodeAt(0)){if('*'===o)return!0;if(r[i]!==o)return!1}}return!0},jR.location=function(r,t){if(jR.isReady){var n=r.indexOf('?');n!==-1&&(r=r.substring(0,n)),r=JRFU.prepareUrl(r),r=JRFU.path(r);var e=this,i=e._route(r),o=[],a=!0,s=[];s.push.apply(s,i);for(var u=0,l=i.length;u<l;u++)i[u]=i[u].toLowerCase();e.isRefresh=t||!1,e.count++,!t&&e.url.length&&e.history[e.history.length-1]!==e.url&&(e.history.push(e.url),e.history.length>e.LIMIT_HISTORY&&e.history.shift());for(var l=e.routes.length,u=0;u<l;u++){var c=e.routes[u];if(e._route_compare(i,c.url)&&(c.url.indexOf('*')===-1&&(a=!1),!(c.once&&c.count>0))){c.count++,o.push(c);break}}var h=!1,f=[];e.url.length&&(e.cache[e.url]=e.repository),e.url=r,e.repository=e.cache[r],e.repository||(e.repository={}),e._params(),e.params=e._route_param(s,c),e.is404=!1,e.emit('location',r),l=o.length;for(var u=0;u<l;u++){var c=o[u];if(!c.pending)if(c.middleware&&c.middleware.length)!function(r){for(var t=r.middleware.length,n=[],i=0;i<t;i++)!function(r,t){n.push(function(n){t.call(e,n,r)})}(r,jR.middlewares[r.middleware[i]]);return r.init?(r.pending=!0,r.init(function(){n.middleware(function(t){!t&&r.fn.apply(e,e.params),r.pending=!1})}),void(r.init=null)):(r.pending=!0,void n.middleware(function(t){!t&&r.fn.apply(e,e.params),r.pending=!1}))}(c);else{if(!c.init){c.fn.apply(e,e.params);continue}c.pending=!0,function(r){r.init(function(){r.fn.apply(e,e.params),r.pending=!1})}(c),c.init=null}}h&&e.status(500,f),e.is404=!0,a&&e.status(404,new Error('Route not found.'))}},jR.prev=function(){return this.history[this.history.length-1]},jR.back=function(){var r=this,t=r.history.pop()||'/';return r.url='',r.redirect(t,!0),r},jR.status=function(r,t){var n=this;return n.emit('status',r||404,t),n},jR.redirect=function(r,t){var n=this;return 35===r.charCodeAt(0)?(location.hash=r,n.model=t||null,n.location(r,!1),n):n.isModernBrowser?(history.pushState(null,null,r),n.model=t||null,n.location(r,!1),n):(location.href=r,!1)},jR._params=function(){for(var r=this,t={},n=location.href.slice(location.href.indexOf('?')+1).split('&'),e=0;e<n.length;e++){var i=n[e].split('=');if(2===i.length){var o=decodeURIComponent(i[0]),a=decodeURIComponent(i[1]),s=t[o]instanceof Array;t[o]&&!s&&(t[o]=[t[o]]),s?t[o].push(a):t[o]=a}}return r.query=t,r},jR.path=JRFU.path=function(r,t){if('#'===r.substring(0,1))return r;t||(t='/');var n=r.indexOf('?'),e='';n!==-1&&(e=r.substring(n),r=r.substring(0,n));var i=r.length,o=r.substring(i-1,i);return o!==t&&(r+=t),r+e},JRFU.prepareUrl=function(r){if('#'===r.substring(0,1))return r;var t=r.indexOf('#');return t!==-1?r.substring(0,t):r},Array.prototype.middleware||(Array.prototype.middleware=function(r){var t=this,n=t.shift();return void 0===n?(r&&r(),t):(n(function(n){n instanceof Error||n===!1?r&&r(n===!1||n):setTimeout(function(){t.middleware(r)},1)}),t)}),String.prototype.count||(String.prototype.count=function(r){var t=0,n=0;do t=this.indexOf(r,t+r.length),t>0&&n++;while(t>0);return n}),jR.on('error',function(r,t,n){var e=this;e.errors.push({error:r,url:t,name:n,date:new Date}),e.errors.length>e.LIMIT_HISTORY_ERROR&&e.errors.shift()}),jR.clientside=function(r){return $(document).on('click',r,function(r){r.preventDefault();var t=$(this);jR.redirect(t.attr('href')||t.attr('data-jrouting')||t.attr('data-jr'))}),jR},window.jQuery?jRinit():jR.init=setInterval(function(){window.jQuery&&(clearInterval(jR.init),jRinit())},100),setTimeout(jR.async,500),setTimeout(jR.async,1e3),setTimeout(jR.async,2e3),setTimeout(jR.async,3e3),setTimeout(jR.async,5e3),window.ROUTE=function(r,t,n,e){return jR.route(r,t,n,e)};