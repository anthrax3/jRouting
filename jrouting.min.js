function jRinit(){jRouting.async(),$.fn.jRouting=function(n){if(!jRouting.isModernBrowser)return this;var t=function(n){n.preventDefault(),jRouting.redirect($(this).attr("href"))};return n?($(document).on("click",this.selector,t),this):(this.filter("a").bind("click",t),this)},$(document).ready(function(){jRouting.async(),jRouting.hashtags?jRouting.url=location.hash||JRFU.path(JRFU.prepareUrl(location.pathname)):jRouting.url=JRFU.path(JRFU.prepareUrl(location.pathname)),jRouting.events.ready?(jRouting.emit("ready",jRouting.url),jRouting.emit("load",jRouting.url)):setTimeout(function(){jRouting.isReady=!0,jRouting.location(jRouting.url),jRouting.emit("ready",jRouting.url),jRouting.emit("load",jRouting.url)},5),$(window).on("hashchange",function(){jRouting.isReady&&jRouting.hashtags&&jRouting.location(JRFU.path(location.hash))}),$(window).on("popstate",function(){jRouting.isReady&&!jRouting.hashtags&&jRouting.location(JRFU.path(location.pathname))})})}var JRFU={},jRouting={LIMIT_HISTORY:100,LIMIT_HISTORY_ERROR:100,version:"v1.3.1",cache:{},routes:[],history:[],errors:[],events:{},eventsOnce:{},global:{},query:{},params:[],middlewares:{},repository:{},url:"",model:null,isFirst:!0,isReady:!1,isRefresh:!1,isModernBrowser:"undefined"!=typeof history.pushState,hashtags:!1,count:0};window.jRouting||(window.jRouting=jRouting),window.JRFU||(window.JRFU=JRFU),jRouting.on=function(n,t){var i=this,r=i.events[n];return r?(r.push(t),i):(i.events[n]=[t],i)},jRouting.once=function(n,t){var i=this,r=i.eventsOnce[n];return r?(r.push(t),i):(i.eventsOnce[n]=[t],i)},jRouting.emit=function(n){var t=this,i=t.events[n]||[],r=t.eventsOnce[n]||[],e=i.length,o=r.length;if(!e&&!o)return t;for(var u=[],a=arguments.length,s=1;a>s;s++)u.push(arguments[s]);if(e>0)for(var s=0;e>s;s++)i[s].apply(t,u);if(o){for(var s=0;e>s;s++)r[s].apply(t,u);delete t.eventsOnce[n]}},jRouting.route=function(n,t,i,r){var e;if(t instanceof Array){var e=i;i=t,t=e}"function"==typeof i&&(e=r,r=i,i=e);var o=this,u=n.count("/")+(-1===n.indexOf("*")?0:10),a=o._route(n.trim()),s=[];if("string"==typeof i&&(i=i.split(",")),-1!==n.indexOf("{")){u-=100;for(var l=0;l<a.length;l++)"{"===a[l].substring(0,1)&&s.push(l);u-=s.length}return o.routes.push({url:a,fn:t,priority:u,params:s,middleware:i||null,init:r,count:0,pending:!1}),o.routes.sort(function(n,t){return n.priority>t.priority?-1:n.priority<t.priority?1:0}),o},jRouting.middleware=function(n,t){var i=this;return i.middlewares[n]=t,i},jRouting.refresh=function(){var n=this;return n.location(n.url,!0)},jRouting.reload=function(){return jRouting.refresh()},jRouting.async=function(){if(window.jRoute&&window.jRoute.length){for(;;){var n=window.jRoute.shift();if(!n)break;n()}jRouting.is404&&jRouting.location(jRouting.url)}},jRouting._route=function(n){"/"===n.charIndex(0)&&(n=n.substring(1)),"/"===n.charIndex(n.length-1)&&(n=n.substring(0,n.length-1));var t=n.split("/");return 1!==t.length||t[0]||(t[0]="/"),t},jRouting._route_param=function(n,t){var i=[];if(!t||!n)return i;var r=t.params.length;if(!r)return i;for(var e=0;r>e;e++){var o=n[t.params[e]];i.push("/"===o?"":o)}return i},jRouting._route_compare=function(n,t){var i=n.length,r=1===i&&"/"===n[0];if(t.length!==i)return!1;for(var e=0;i>e;e++){var o=t[e];if("undefined"==typeof o)return!1;if(r||"{"!==o.charIndex(0)){if("*"===o)return!0;if(n[e]!==o)return!1}}return!0},jRouting.location=function(n,t){if(jRouting.isReady){var i=n.indexOf("?");-1!==i&&(n=n.substring(0,i)),n=JRFU.prepareUrl(n),n=JRFU.path(n);var r=this,e=r._route(n),o=[],u=!0,a=[];a.push.apply(a,e);for(var s=0,l=e.length;l>s;s++)e[s]=e[s].toLowerCase();r.isRefresh=t||!1,r.count++,t||r.url.length&&r.history[r.history.length-1]!==r.url&&(r.history.push(r.url),r.history.length>r.LIMIT_HISTORY&&r.history.shift());for(var l=r.routes.length,s=0;l>s;s++){var h=r.routes[s];if(r._route_compare(e,h.url)&&(-1===h.url.indexOf("*")&&(u=!1),!(h.once&&h.count>0))){h.count++,o.push(h);break}}var g=!1,f=[];r.url.length&&(r.cache[r.url]=r.repository),r.url=n,r.repository=r.cache[n],r.repository||(r.repository={}),r._params(),r.params=r._route_param(a,h),r.is404=!1,r.emit("location",n),l=o.length;for(var s=0;l>s;s++){var h=o[s];if(!h.pending)if(h.middleware&&h.middleware.length)!function(n){for(var t=n.middleware.length,i=[],e=0;t>e;e++)!function(n,t){i.push(function(i){t.call(r,i,n)})}(n,jRouting.middlewares[n.middleware[e]]);return n.init?(n.pending=!0,n.init(function(){i.middleware(function(){err||n.fn.apply(r,r.params),n.pending=!1})}),void(n.init=null)):(n.pending=!0,void i.middleware(function(t){t||n.fn.apply(r,r.params),n.pending=!1}))}(h);else{if(!h.init){h.fn.apply(r,r.params);continue}h.pending=!0,function(n){n.init(function(){n.fn.apply(r,r.params),n.pending=!1})}(h),h.init=null}}g&&r.status(500,f),r.is404=!0,u&&r.status(404,new Error("Route not found."))}},jRouting.prev=function(){var n=this;return n.history[n.history.length-1]},jRouting.back=function(){var n=this,t=n.history.pop()||"/";return n.url="",n.redirect(t,!0),n},jRouting.status=function(n,t){var i=this;return i.emit("status",n||404,t),i},jRouting.redirect=function(n,t){var i=this;return"#"===n.substring(0,1)?(location.hash=n,i.model=t||null,i.location(n,!1),i):i.isModernBrowser?(history.pushState(null,null,n),i.model=t||null,i.location(n,!1),i):(location.href=n,!1)},jRouting._params=function(){for(var n=this,t={},i=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<i.length;r++){var e=i[r].split("=");if(2===e.length){var o=decodeURIComponent(e[0]),u=decodeURIComponent(e[1]),a=t[o]instanceof Array;"undefined"==typeof t[o]||a||(t[o]=[t[o]]),a?t[o].push(u):t[o]=u}}return n.query=t,n},JRFU.path=function(n,t){if("#"===n.substring(0,1))return n;"undefined"==typeof t&&(t="/");var i=n.indexOf("?"),r="";-1!==i&&(r=n.substring(i),n=n.substring(0,i));var e=n.charIndex(n.length-1);return e!==t&&(n+=t),n+r},String.prototype.count||(String.prototype.count=function(n){var t=0,i=0;do t=this.indexOf(n,t+n.length),t>0&&i++;while(t>0);return i}),String.prototype.charIndex||(String.prototype.charIndex=function(n){return this.toString().substring(n,n+1)}),jRouting.path=JRFU.path=function(n,t){if("#"===n.substring(0,1))return n;"undefined"==typeof t&&(t="/");var i=n.indexOf("?"),r="";-1!==i&&(r=n.substring(i),n=n.substring(0,i));var e=n.charIndex(n.length-1);return e!==t&&(n+=t),n+r},JRFU.prepareUrl=function(n){return"#"===n.substring(0,1)?n:(index=n.indexOf("#"),-1!==index?n.substring(0,index):n)},Array.prototype.middleware||(Array.prototype.middleware=function(n){var t=this,i=t.shift();return void 0===i?(n&&n(),t):(i(function(i){return i instanceof Error||i===!1?void(n&&n(i===!1?!0:i)):void setTimeout(function(){t.middleware(n)},1)}),t)}),jRouting.on("error",function(n,t,i){var r=this;r.errors.push({error:n,url:t,name:i,date:new Date}),r.errors.length>r.LIMIT_HISTORY_ERROR&&r.errors.shift()}),window.jQuery?jRinit():jRouting.init=setInterval(function(){window.jQuery&&(clearInterval(jRouting.init),jRinit())},100),window.jR=jRouting,setTimeout(jRouting.async,500),setTimeout(jRouting.async,1e3),setTimeout(jRouting.async,2e3),setTimeout(jRouting.async,3e3),setTimeout(jRouting.async,5e3);