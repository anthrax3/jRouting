function jRinit(){jR.async(),$.fn.jRouting=function(t){if(jR.hashtags||!jR.isModernBrowser)return this;var r=$.fn.jquery.replace(/\./g,'').parseInt();if(r>=300&&t===!0)throw Error('$(selector).jRouting() doesn\'t work in jQuery +3. Instead of this use jR.clientside(selector).');var n=function(t){t.preventDefault(),jR.redirect($(this).attr('href'))};return t?$(document).on('click',this.selector,n):this.filter('a').bind('click',n),this},$(document).ready(function(){jR.async(),jR.hashtags?jR.url=location.hash||JRFU.path(JRFU.prepareUrl(location.pathname)):jR.url=JRFU.path(JRFU.prepareUrl(location.pathname)),setTimeout(function(){jR.isReady=!0,jR.location(jR.url)},5),$(window).on('hashchange',function(){jR.isReady&&jR.hashtags&&jR.location(JRFU.path(location.hash))}),$(window).on('popstate',function(){if(jR.isReady&&!jR.hashtags){var t=JRFU.path(location.pathname);jR.url!==t&&jR.location(t)}})})}var JRFU={},jR={LIMIT_HISTORY:100,LIMIT_HISTORY_ERROR:100,version:'v3.0.0',cache:{},routes:[],history:[],errors:[],global:{},query:{},params:[],middlewares:{},repository:{},url:'',model:null,isFirst:!0,isReady:!1,isRefresh:!1,isModernBrowser:!!history.pushState,hashtags:!1,count:0};window.jR||(window.jR=jR),window.jRouting||(window.jRouting=jR),window.JRFU||(window.JRFU=JRFU),window.NAVIGATION||(window.NAVIGATION=jR),jR.remove=function(t){for(var r=this,n=[],e=0,i=r.routes.length;e<i;e++)r.routes[e].id!==t&&n.push(r.routes[e]);return r.routes=n,r},jR.on=function(t,r){return ON(t,r),self},jR.emit=function(){EMIT.apply(window,arguments)},jR.route=function(t,r,n,e){var i;if(r instanceof Array){var i=n;n=r,r=i}'function'==typeof n&&(i=e,e=n,n=i);var o=this,a=t.count('/')+(t.indexOf('*')===-1?0:10),u=o._route(t.trim()),s=[];if('string'==typeof n&&(n=n.split(',')),t.indexOf('{')!==-1){a-=100;for(var l=0;l<u.length;l++)'{'===u[l].substring(0,1)&&s.push(l);a-=s.length}return o.routes.remove(t),o.routes.push({id:t,url:u,fn:r,priority:a,params:s,middleware:n||null,init:e,count:0,pending:!1}),o.routes.sort(function(t,r){return t.priority>r.priority?-1:t.priority<r.priority?1:0}),o},jR.middleware=function(t,r){var n=this;return n.middlewares[t]=r,n},jR.refresh=function(){var t=this;return t.location(t.url,!0)},jR.reload=function(){return jR.refresh()},jR.async=function(){if(window.jRoute&&window.jRoute.length){for(;;){var t=window.jRoute.shift();if(!t)break;t()}jR.is404&&jR.location(jR.url)}},jR._route=function(t){47===t.charCodeAt(0)&&(t=t.substring(1)),47===t.charCodeAt(t.length-1)&&(t=t.substring(0,t.length-1));var r=t.split('/');return 1!==r.length||r[0]||(r[0]='/'),r},jR._route_param=function(t,r){var n=[];if(!r||!t)return n;var e=r.params.length;if(e)for(var i=0;i<e;i++){var o=t[r.params[i]];n.push('/'===o?'':o)}return n},jR._route_compare=function(t,r){var n=t.length,e=1===n&&'/'===t[0];if(r.length!==n)return!1;for(var i=0;i<n;i++){var o=r[i];if(!o)return!1;if(e||123!==o.charCodeAt(0)){if('*'===o)return!0;if(t[i]!==o)return!1}}return!0},jR.location=function(t,r){if(jR.isReady){var n=t.indexOf('?');n!==-1&&(t=t.substring(0,n)),t=JRFU.prepareUrl(t),t=JRFU.path(t);var e=this,i=e._route(t),o=[],a=!0,u=[];u.push.apply(u,i);for(var s=0,l=i.length;s<l;s++)i[s]=i[s].toLowerCase();e.isRefresh=r||!1,e.count++,!r&&e.url.length&&e.history[e.history.length-1]!==e.url&&(e.history.push(e.url),e.history.length>e.LIMIT_HISTORY&&e.history.shift());for(var l=e.routes.length,s=0;s<l;s++){var c=e.routes[s];if(e._route_compare(i,c.url)&&(c.url.indexOf('*')===-1&&(a=!1),!(c.once&&c.count>0))){c.count++,o.push(c);break}}var h=!1,f=[];e.url.length&&(e.cache[e.url]=e.repository),e.url=t,e.repository=e.cache[t],e.repository||(e.repository={}),e._params(),e.params=e._route_param(u,c),e.is404=!1,e.emit('location',t),l=o.length;for(var s=0;s<l;s++){var c=o[s];if(!c.pending)if(c.middleware&&c.middleware.length)!function(t){for(var r=t.middleware.length,n=[],i=0;i<r;i++)!function(t,r){n.push(function(n){r.call(e,n,t)})}(t,jR.middlewares[t.middleware[i]]);return t.init?(t.pending=!0,t.init(function(){n.middleware(function(){!err&&t.fn.apply(e,e.params),t.pending=!1})}),void(t.init=null)):(t.pending=!0,void n.middleware(function(r){!r&&t.fn.apply(e,e.params),t.pending=!1}))}(c);else{if(!c.init){c.fn.apply(e,e.params);continue}c.pending=!0,function(t){t.init(function(){t.fn.apply(e,e.params),t.pending=!1})}(c),c.init=null}}h&&e.status(500,f),e.is404=!0,a&&e.status(404,new Error('Route not found.'))}},jR.prev=function(){return this.history[this.history.length-1]},jR.back=function(){var t=this,r=t.history.pop()||'/';return t.url='',t.redirect(r,!0),t},jR.status=function(t,r){var n=this;return n.emit('status',t||404,r),n},jR.redirect=window.REDIRECT=function(t,r){var n=this;return 35===t.charCodeAt(0)?(location.hash=t,n.model=r||null,n.location(t,!1),n):n.isModernBrowser?(history.pushState(null,null,t),n.model=r||null,n.location(t,!1),n):(location.href=t,!1)},jR._params=function(){for(var t=this,r={},n=location.href.slice(location.href.indexOf('?')+1).split('&'),e=0;e<n.length;e++){var i=n[e].split('=');if(2===i.length){var o=decodeURIComponent(i[0]),a=decodeURIComponent(i[1]),u=r[o]instanceof Array;r[o]&&!u&&(r[o]=[r[o]]),u?r[o].push(a):r[o]=a}}return t.query=r,t},jR.path=JRFU.path=function(t,r){if('#'===t.substring(0,1))return t;r||(r='/');var n=t.indexOf('?'),e='';n!==-1&&(e=t.substring(n),t=t.substring(0,n));var i=t.length,o=t.substring(i-1,i);return o!==r&&(t+=r),t+e},JRFU.prepareUrl=function(t){return'#'===t.substring(0,1)?t:(index=t.indexOf('#'),index!==-1?t.substring(0,index):t)},Array.prototype.middleware||(Array.prototype.middleware=function(t){var r=this,n=r.shift();return void 0===n?(t&&t(),r):(n(function(n){n instanceof Error||n===!1?t&&t(n===!1||n):setTimeout(function(){r.middleware(t)},1)}),r)}),String.prototype.count||(String.prototype.count=function(t){var r=0,n=0;do r=this.indexOf(t,r+t.length),r>0&&n++;while(r>0);return n}),jR.clientside=function(t){return $(document).on('click',t,function(t){t.preventDefault();var r=$(this);jR.redirect(r.attr('href')||r.attr('data-jrouting')||r.attr('data-jr'))}),jRouting},window.jQuery?jRinit():jR.init=setInterval(function(){window.jQuery&&(clearInterval(jR.init),jRinit())},100),setTimeout(jR.async,500),setTimeout(jR.async,1e3),setTimeout(jR.async,2e3),setTimeout(jR.async,3e3),setTimeout(jR.async,5e3),window.ROUTE=function(t,r,n,e){return jR.route(t,r,n,e)};